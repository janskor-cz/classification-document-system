{
  "$id": "https://classification-system.example.com/schemas/classification-credential/v2.0",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Classification Document Access Credential",
  "description": "W3C Verifiable Credential schema for classification-based document access control",
  "type": "object",
  "properties": {
    "credentialSubject": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "DID of the credential subject",
          "pattern": "^did:"
        },
        "fullName": {
          "type": "string",
          "description": "Full legal name of the credential holder",
          "minLength": 2,
          "maxLength": 100
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "Corporate email address"
        },
        "employeeId": {
          "type": "string",
          "description": "Unique employee identifier",
          "pattern": "^[A-Z0-9-]+$"
        },
        "department": {
          "type": "string",
          "description": "Department or organizational unit",
          "maxLength": 50
        },
        "jobTitle": {
          "type": "string",
          "description": "Official job title",
          "maxLength": 100
        },
        "securityClearance": {
          "type": "object",
          "properties": {
            "level": {
              "type": "integer",
              "description": "Numeric classification level",
              "minimum": 0,
              "maximum": 4
            },
            "label": {
              "type": "string",
              "enum": ["public", "internal", "confidential", "restricted", "top-secret"],
              "description": "Human-readable classification level"
            },
            "grantedBy": {
              "type": "string",
              "description": "Authority that granted this clearance"
            },
            "validFrom": {
              "type": "string",
              "format": "date-time",
              "description": "ISO8601 date when clearance becomes valid"
            },
            "validUntil": {
              "type": "string",
              "format": "date-time",
              "description": "ISO8601 date when clearance expires"
            }
          },
          "required": ["level", "label", "grantedBy", "validFrom", "validUntil"]
        },
        "documentAccessRights": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": [
              "read_public",
              "read_internal", 
              "read_confidential",
              "read_restricted",
              "read_top_secret",
              "create_public",
              "create_internal",
              "create_confidential", 
              "create_restricted",
              "create_top_secret",
              "modify_public",
              "modify_internal",
              "modify_confidential",
              "modify_restricted",
              "modify_top_secret",
              "delete_public",
              "delete_internal",
              "delete_confidential",
              "delete_restricted",
              "delete_top_secret"
            ]
          },
          "description": "Specific document access permissions"
        },
        "enterpriseContext": {
          "type": "object",
          "properties": {
            "organizationName": {
              "type": "string",
              "description": "Name of the issuing organization"
            },
            "organizationDID": {
              "type": "string",
              "pattern": "^did:",
              "description": "DID of the issuing organization"
            },
            "tenantId": {
              "type": "string",
              "description": "Multi-tenant identifier"
            },
            "policyVersion": {
              "type": "string",
              "description": "Version of security policy applied"
            }
          },
          "required": ["organizationName", "tenantId"]
        },
        "issuanceMetadata": {
          "type": "object",
          "properties": {
            "issuedAt": {
              "type": "string",
              "format": "date-time",
              "description": "ISO8601 timestamp of credential issuance"
            },
            "issuedBy": {
              "type": "string",
              "description": "Name or DID of the issuing authority"
            },
            "credentialVersion": {
              "type": "string",
              "description": "Version of this credential format",
              "default": "2.0"
            },
            "revocationRegistryId": {
              "type": "string",
              "description": "Identifier for revocation registry"
            },
            "credentialStatus": {
              "type": "string",
              "enum": ["active", "suspended", "revoked"],
              "default": "active"
            }
          },
          "required": ["issuedAt", "issuedBy", "credentialVersion"]
        }
      },
      "required": [
        "id",
        "fullName", 
        "email",
        "securityClearance",
        "documentAccessRights",
        "enterpriseContext",
        "issuanceMetadata"
      ]
    }
  },
  "required": ["credentialSubject"],
  "additionalProperties": false
}